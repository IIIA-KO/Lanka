@let status = status$ | async;

<main class="callback-wrapper fade-in-up">
  <p-card styleClass="callback-card">
    <header class="callback-header">
      <span class="callback-chip">
        <i class="pi pi-refresh" aria-hidden="true"></i>
        {{ 'RENEW_INSTAGRAM_CALLBACK.LABEL' | translate }}
      </span>
      <h2>{{ 'RENEW_INSTAGRAM_CALLBACK.TITLE' | translate }}</h2>
      <p>{{ 'RENEW_INSTAGRAM_CALLBACK.DESCRIPTION' | translate }}</p>
    </header>

    <app-instagram-status-banner
      [status]="status"
      [hideWhenEmpty]="false"
      title="RENEW_INSTAGRAM_CALLBACK.STATUS_TITLE"
    ></app-instagram-status-banner>

    <section class="callback-body">
      <p class="status-hint">{{ fallbackMessage | translate }}</p>

      @if (isProcessing && (!status || !status.isFinal)) {
        <div class="status-progress" aria-live="polite">
          <p-progressSpinner
            [style]="{ width: '1.25rem', height: '1.25rem' }"
            strokeWidth="4"
          ></p-progressSpinner>
          <span>{{ 'RENEW_INSTAGRAM_CALLBACK.WAITING_TOKEN' | translate }}</span>
        </div>
      }

      @if (status?.status === 'failed') {
        <div class="callback-actions">
          <p-button
            [label]="'RENEW_INSTAGRAM_CALLBACK.RETURN' | translate"
            [outlined]="true"
            severity="secondary"
            (onClick)="goBack()"
          ></p-button>
        </div>
      } @else if (status?.status === 'completed') {
        <div class="callback-actions">
          <p-button
            [label]="'RENEW_INSTAGRAM_CALLBACK.CONTINUE' | translate"
            (onClick)="goBack()"
          ></p-button>
        </div>
      }
    </section>
  </p-card>
</main>
